<!DOCTYPE html>
<html>
<head>
    <title>{{ project.p_name }}</title>
</head>
<body>
    <h1>{{ project.p_name }}</h1>
    <p>Description: {{ project.p_description }}</p>
    <p>Due Date: {{ project.p_due_date }}</p>
    
    {% if user_type == 'manager' %}
    <a href="{% url 'create_task' project.id %}">Create New Task</a>
    <a href="{% url 'update_project' project.id %}">Edit Project</a>
    <a href="{% url 'delete_project' project.id %}" class="delete-btn">Delete Project</a>
    {% endif %}
    
    <h2>Tasks</h2>
    <ul>
    {% for task in tasks %}
        <li>
            {{ task.t_name }} - {{ task.t_status }}
            (Due: {{ task.t_due_date }})
            {% if user_type == 'manager' %}
            <a href="{% url 'update_task' project.id task.id %}">Edit</a>
            <a href="{% url 'delete_task' project.id task.id %}" class="delete-btn">Delete Task</a>
            {% endif %}
            
            {% if user_type == 'teammate' %}
            <form method="POST" action="{% url 'update_task_status' id=project.id t_id=task.id %}">
                {% csrf_token %}
                <select name="status">
                    {% for value, display in task.STATUS_CHOICES %}
                    <option value="{{ value }}" {% if task.t_status == value %}selected{% endif %}>
                        {{ display }}
                    </option>
                    {% endfor %}
                </select>
                <button type="submit">Update</button>
            </form>
            {% endif %}
            
        </li>
    {% endfor %}
    </ul>
</body>
</html>